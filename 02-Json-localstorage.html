<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Json-LocalStorage</title>
</head>
<body>
    <h1>Rock Paper Scissor with Computer</h1>
    <button onclick="handleClick('rock')">Rock</button> 
    <button onclick="handleClick('paper')">Paper</button> 
    <button onclick="handleClick('scissor')">Scissor</button>
    <button onclick="
        score.tie = 0;
        score.win = 0;
        score.lose = 0;
        handleUpdate();
    ">
    Reset score</button>
    <script>
        //Default operator short circuit
        const score = JSON.parse(localStorage.getItem('score')) || 
        {
            win:0,
            lose:0,
            tie:0
        };

        function handleUpdate(){
            localStorage.setItem('score',JSON.stringify(score));
        }

        function handleClick(humanMove){
            const num = Math.random();
            let computerMove = 'rock';
            let result='Start Game';
            if (0<=num && num<=1/3){
                computerMove = 'rock'
            }
            else if(1/3<num && num<=2/3){
                computerMove = 'paper'
            }
            else{
                computerMove = 'scissor'
            }
            if (humanMove==="rock") {
                if(computerMove==='rock'){
                    score.tie++;
                    result = 'Match Tied.'
                }  
                else if(computerMove==='paper')  {
                    score.lose++;
                    result = 'You Lose.'
                }
                else{
                    score.win++;
                    result = 'You Win.';
                }
            }
            else if (humanMove==="paper") {
                if(computerMove==='paper'){
                    score.tie++;
                    result = 'Match Tied.'
                }  
                else if(computerMove==='scissor')  {
                    score.lose++;
                    result = 'You Lose.'
                }
                else{
                    score.win++;
                    result = 'You Win.';
                }
            }
            else{
                if(computerMove==='scissor'){
                    score.tie++;
                    result = 'Match Tied.'
                }  
                else if(computerMove==='stone')  {
                    score.lose++;
                    result = 'You Lose.'
                }
                else{
                    score.win++;
                    result = 'You Win.';
                }
            }
            handleUpdate();
            alert(`Your Move: ${humanMove}
Random Move: ${computerMove}
Result: ${result}
Win: ${score.win}
Lose: ${score.lose}
Tie: ${score.tie}
`)
            
        }

    </script>
</body>
</html>
